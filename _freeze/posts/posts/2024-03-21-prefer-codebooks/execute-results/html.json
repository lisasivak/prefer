{
  "hash": "f41b3c70e256e84679cc24c2fe34c02e",
  "result": {
    "markdown": "---\ntitle: \"A guide on PreFer codebooks [LISS]\"\ndescription: |\n  Here is some useful information that can help navigate the PreFer codebooks for the LISS datasets   \ncategories:\n  - LISS\n  - dataset\n  - guide\nauthor: \n  - \"Gert Stulp\"\n  - \"Lisa Sivak\"\ndate: '2024-03-21'\ntoc: true\nimage: ../../images/liss_pick.png\nimage-alt: LISS logo. \nlanguage: \n    section-title-footnotes: References\n---\n\n\nHere we describe how to make use the codebooks [`PreFer_codebook.csv`](../../data/PreFer_codebook.csv) and [`PreFer_codebook_summary.csv`](../../data/PreFer_codebook_summary.csv). Broadly speaking, the first codebook is most useful to examine the meaning and characteristics of individual variables and their values and the second is most useful to see how the measurement of particular variables may have changed over time. \n\nThere are also detailed codebooks in Dutch and English on the [LISS website](https://www.dataarchive.lissdata.nl/study-units/view/1). They contain important information, e.g. about filtering, which can be useful for working with missing values.\n\nHere we describe how to use the PreFer codebooks.\n\n# PreFer_codebook.csv\n\nThis codebook contains metadata on all 31634 variables in the dataset `PreFer_train_data.csv` (and `PreFer_train_supplementary_data.csv`) and the 33 variables in the `PreFer_background_data.csv`. \n\nThe codebook contains the following variables:\n\n- **\"var_name\"**; name of variables.\n\n- **\"var_label\"**; the variable label; this is either a description of the variable or the survey question asked to respondents.\n\n- **\"values_cat\"**; the different values in the variable that had labels associated with these values (see variable `labels_cat`). For instance, \"1; 2\" in `values_cat` and \"Male; Female\" in `labels_cat` means that value 1 corresponds to males, and 2 to females.\n\n- **\"labels_cat\"**; the labels associated with the values in `values_cat`. For instance, \"1; 2\" in `values_cat` and \"Male; Female\" in `labels_cat` means that value 1 corresponds to males, and 2 to females.\n\n- **\"unique_values_n\"**; indicates how many unique values exist in the variable (**excluding** missing (NA) values, which certainly exist). This is `NA` for `nomem_encr` and `nohouse_encr` because these vary for each wave and survey. \n\n- **\"n_missing\"**; number of missing cases.\n\n- **\"prop_missing\"**; proportion of missing cases within survey (i.e., n_missing / n who did the specific survey)\n\n- **\"type_var\"**; assessment of the type of variable, with possibilities empty, \"numeric\", \"categorical\", \"open-ended question\", \"date or time\", and \"character [almost exclusively empty strings]\". When a variable had value labels (see `value_labels`), and these value labels were of character type (e.g., 1 = \"female\", 2 = \"male\"), then we considered the variable to be \"categorical\". When a variable had no value labels, and the values in the variable were numeric, we considered the variable to be \"numeric\". When a variable had value labels and none of the value labels were present in the data, and the values in the variable were numeric, we considered the variables to be \"numeric\". For example, the variable `cf08a005` had value labels \"`I don't know` = 99999\", but `99999` was not present in the variable. Given that all values of the variable were numeric, we considered this variable to be numeric. We considered the value labels to be erroneous and updated the variables `value_labels` and `value_labels_n` to reflect this. We made a note in the variable `note`. The category \"character [almost exclusively empty strings]\" was reserved for variables that were strictly speaking of type character but that exclusively or nearly exclusively consisted of missing value and empty strings.\n\n- **\"note\"**; describes decisions we made in determining the type of the variable (see `type_var`) and the changes we made to the data. \n\n- **\"year\"**; indicates year of survey/wave.      \n\n- **\"survey\"**; indicates in which core survey this variable is assessed.\n\n- **\"dataset\"**; variable can be found in this dataset.\n\n## Finding variables\n\nAn important aim of the codebook is to get insight on individual variables. \n\n### Example 1\nImagine you are interested in what the variable `cp12e007` means. You can just open the codebook in an editor and look for it:\n\n![](../../images/cp12e007.png){width=50%}\n\nYou can also do that via R or Python. In R:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr) # for nicer output tables in html\ncodebook <- readr::read_csv(\"../../data/PreFer_codebook.csv\") \n# you can also find this codebook at preferdatachallenge.nl/data/PreFer_codebook.csv\n\ncodebook[ codebook$var_name == \"cp12e007\", ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 12\n  var_name var_label             values_cat labels_cat unique_values_n n_missing\n  <chr>    <chr>                 <chr>      <chr>                <dbl>     <dbl>\n1 cp12e007 I receive far too ma… 1; 2; 3; … 1 totally…               7         1\n# ℹ 6 more variables: prop_missing <dbl>, type_var <chr>, note <chr>,\n#   year <dbl>, survey <chr>, dataset <chr>\n```\n:::\n:::\n\n\nThis variable contained an answer to the question \"I receive far too many requests to participate in surveys.\". It came from the 2012 Personality core survey. This is a categorical variable and has 7 possible values (from 1 to 7, see `values_cat`) which reflects a Likert scale because it has value labels (1 totally disagree; 2; 3; 4; 5; 6; 7 totally agree; see `labels_cat`). In the data, 7 unique values were actually observed (see `unique_values_n`), which does not need to be the case. In this 2012 wave of this Personality core survey, there was only 1 missing value (`n_missing`), which meant  0.0001679825 was missing (and that 1/0.0001679825 = 5953 participated in the survey). There is no `note` meaning no problems were observed for this particular variable. \n\n### Example 2\nLet's examine whether any variable labels (or question labels) say anything about income. \n\n::: {.cell}\n\n```{.r .cell-code}\ncodebook[ grepl(\"income\", codebook$var_label), ] # 1192 variables!\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,192 × 12\n   var_name var_label            values_cat labels_cat unique_values_n n_missing\n   <chr>    <chr>                <chr>      <chr>                <dbl>     <dbl>\n 1 ci08a008 Did you receive inc… 1; 2       yes; no                  2        50\n 2 ci09b008 Did you receive inc… 1; 2       yes; no                  2        27\n 3 ci10c008 Did you receive inc… 1; 2       yes; no                  2        62\n 4 ci11d008 Did you receive inc… 1; 2       yes; no                  2        87\n 5 ci12e008 Did you receive inc… 1; 2       yes; no                  2        40\n 6 ci13f008 Did you receive inc… 1; 2       yes; no                  2        81\n 7 ci14g008 Did you receive inc… 1; 2       yes; no                  2        41\n 8 ci15h008 Did you receive inc… 1; 2       yes; no                  2        68\n 9 ci16i008 Did you receive inc… 1; 2       yes; no                  2        32\n10 ci17j008 Did you receive inc… 1; 2       yes; no                  2        32\n# ℹ 1,182 more rows\n# ℹ 6 more variables: prop_missing <dbl>, type_var <chr>, note <chr>,\n#   year <dbl>, survey <chr>, dataset <chr>\n```\n:::\n:::\n\n \nLet's focus on the variable `netinc`:\n\n::: {.cell}\n\n```{.r .cell-code}\ncodebook[ codebook$var_name == \"netinc\", ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 12\n  var_name var_label             values_cat labels_cat unique_values_n n_missing\n  <chr>    <chr>                 <chr>      <chr>                <dbl>     <dbl>\n1 netinc   Personal net monthly… <NA>       <NA>                  3810    426190\n# ℹ 6 more variables: prop_missing <dbl>, type_var <chr>, note <chr>,\n#   year <dbl>, survey <chr>, dataset <chr>\n```\n:::\n:::\n\n\nThis variable measures personal net monthly income in euro. This is a numeric variable, and about 24% is missing. This is a background variable which means that it is recorded monthly for respondents. This variable can be found in `PreFer_train_background_data.csv`. At one point in time this variable had value labels associated with it: `Unknown (missing)` = -15, `Prefer not to say` = -14, `I dont know` = -13. However, these values were never observed in the actual data, which is why we removed these value labels from the variable `var_label` and why we turned this variable into `numeric` (from categorical). This process is described in `note`.\n\n## Variable types\n\nMost variables types are either categorical (meaning that values have labels associated with them, e.g., 1 = \"Male\", 2 = \"Female\") or numeric.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(codebook$type_var)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                                 categorical \n                                       23571 \ncharacter [almost exclusively empty strings] \n                                          15 \n                                date or time \n                                         566 \n                                     numeric \n                                        6436 \n             response to open-ended question \n                                        1079 \n```\n:::\n:::\n\nLet's imagine that in our analyses we only want to select variables that are categorical, numeric, or date or time. Note that we want to select these variable in the Core survey data (the train data) and do not want to include variables from the Background data (for further explanation on the datasets, [click here](2024-03-20-prefer-datasets.qmd)).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nselect_type <- c(\"categorical\", \"numeric\", \"date or time\")\nlist_variables <- codebook[ (codebook$type_var %in% select_type) & \n                              codebook$dataset == \"PreFer_train_data.csv\", ]$var_name\n```\n:::\n\n\nWe can now use this list of variables in our data. Let's use the `PreFer_fake_train.csv` which is a fake dataset that has randomly generated information for 30 cases with identical variable names and structures of variables. \n\n::: {.cell}\n\n```{.r .cell-code}\nfake_data <- readr::read_csv(\"../../data/PreFer_fake_data.csv\")\n# can also be found preferdatachallenge.nl/data/PreFer_fake_data.csv\nfake_data_sel <- fake_data[ , list_variables ]\nhead(fake_data_sel) # brief overview\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 30,540\n  nomem_encr outcome_available cf08a_m cf09b_m cf10c_m cf11d_m cf12e_m cf13f_m\n       <dbl>             <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1     700001                 1  200803  200904  172453  201104  201203  201303\n2     700002                 1  200806  200904   78071  201104  201203  201303\n3     700003                 1  200806  200904  151277  201103  201204  201303\n4     700004                 1  200806  200903  139537  201104  201204  201304\n5     700005                 1  200806  200903   99522  201104  201203  201304\n6     700006                 1  200806  200904  186163  201103  201203  201304\n# ℹ 30,532 more variables: cf14g_m <dbl>, cf15h_m <dbl>, cf16i_m <dbl>,\n#   cf17j_m <dbl>, cf18k_m <dbl>, cf19l_m <dbl>, cf20m_m <dbl>, cf08a001 <dbl>,\n#   cf09b001 <dbl>, cf10c001 <dbl>, cf11d001 <dbl>, cf12e001 <dbl>,\n#   cf13f001 <dbl>, cf14g001 <dbl>, cf15h001 <dbl>, cf16i001 <dbl>,\n#   cf17j001 <dbl>, cf18k001 <dbl>, cf19l001 <dbl>, cf20m001 <dbl>,\n#   cf08a002 <dbl>, cf09b002 <dbl>, cf10c002 <dbl>, cf11d002 <dbl>,\n#   cf12e002 <dbl>, cf13f002 <dbl>, cf14g002 <dbl>, cf15h002 <dbl>, …\n```\n:::\n:::\n\n\n## Using variable information\nIn an earlier example, we observed that variable `cp12e007` was a categorical variable, but from the `labels_cat` it was clear that this was some sort of Likert scale, from \"1 totally disagree; 2; 3; 4; 5; 6; 7 totally agree\" (separated by semi-colons). Let's read-in and parse the values from `values_cat` and the corresponding labels from `labels_cat`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvalues_cp12e007 <- codebook[ codebook$var_name == \"cp12e007\", ]$values_cat # is a string\nvalues_cp12e007 <- strsplit(values_cp12e007, \"; \")[[1]] # to vector\nlabels_cp12e007 <- codebook[ codebook$var_name == \"cp12e007\", ]$labels_cat # is a string\nlabels_cp12e007 <- strsplit(labels_cp12e007, \"; \")[[1]] # to vector\n\n# add information to variable in data\nfake_data_sel$cp12e007 <- factor(fake_data_sel$cp12e007, \n                                 levels = values_cp12e007, labels = labels_cp12e007,\n                                 ordered = TRUE)\nattributes(fake_data_sel$cp12e007)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$levels\n[1] \"1 totally disagree\" \"2\"                  \"3\"                 \n[4] \"4\"                  \"5\"                  \"6\"                 \n[7] \" 7 totally agree\"  \n\n$class\n[1] \"ordered\" \"factor\" \n```\n:::\n:::\n\n\n\n# PreFer_codebook_summary.csv\n\nThe summary codebook is useful to examine whether particular questions have been repeatedly asked to respondents, and whether the questions asked or answer options provided were consistent or modified throughout time. The summary codebook contains the following variables:\n\n- **survey**; indicates in which core survey this variable is assessed\n\n- **\"last3letters\"**; the last 3 letters of the variable name that are consistent throughout waves. Exceptions here are the first three entries, \"nomem_encr\", \" new_child\", and \"*****_m\". \"nomem_encr\" is the unique personal identifier and is used to link all datasets and will never change for an individual; the variable ending with \"_m\" refers to the year and month of the survey (e.g., 200806 -> June 2008)\n\n- **\"var_names\"**; the names of the variables within a particular core surve with the extension in `last3letters` across all the waves it was in         \n\n- **\"n_waves\"**; the number of waves the variable with the extension in `last3letters` used in\n\n- **\"which_waves\"**; in which waves (years) was the variable with the extension in `last3letters` used\n\n- **\"n_different_var_label\"**; the number of different labels of the variables with the extension in `last3letters` across all the waves it was in. A value higher than one implies that the text / question of this variable has changed across waves.    \n\n- **\"var_label_across_waves\"**; the different labels that were used for the variables with the extension in `last3letters` across all the waves it was in.\n\n- **\"n_different_value_labels\"**; the number of different value labels for the variables with the extension in `last3letters` across all the waves it was in. A value higher than one implies that the possible answer categories have changes across waves.    \n\n- **\"value_labels_across_waves\"**; which different values did the variables have with the extension in `last3letters` across all the waves it was in.\n\n- **\"n_different_value_labels\"**; the number of different variable types (e.g., categorical, numeric) of the variables with the extension in `last3letters` across all the waves it was in. A value higher than one implies that the variable type has changed across waves.    \n\n- **\"var_type_across_waves\"**; which different variable types did the variables have with the extension in `last3letters` across all the waves it was in.\n\n## Example interpretation\nHere we examine the variable with the extension `007` both in the \"Family & Household\" and \"Personality\" core surveys.\n\n::: {.cell}\n\n```{.r .cell-code}\ncodebook_summ <- readr::read_csv(\"../../data/PreFer_codebook_summary.csv\")\n# can also be found at preferdatachallenge.nl/data/PreFer_codebook_summary.csv\nsubset(codebook_summ, \n       last3letters == \"007\" & survey %in% c(\"Family & Household\", \"Personality\") )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 11\n  survey        last3letters var_names n_waves which_waves n_different_var_label\n  <chr>         <chr>        <chr>       <dbl> <chr>                       <dbl>\n1 Family & Hou… 007          cf08a007…      13 2008, 2009…                     2\n2 Personality   007          cp08a007…      10 2008, 2009…                     1\n# ℹ 5 more variables: var_label_across_waves <chr>,\n#   n_different_value_labels <dbl>, value_labels_across_waves <chr>,\n#   n_different_var_type <dbl>, var_type_across_waves <chr>\n```\n:::\n:::\n\n\n\nThe variable with the extension (last 3 letters/digits) **007** in the Family & Household survey (\"cf\") featured in 13 waves, from 2008 to 2020. It had the following names across those 13 waves: cf08a007, cf09b007, cf10c007, cf11d007, cf12e007, cf13f007, cf14g007, cf15h007, cf16i007, cf17j007, cf18k007, cf19l007, cf20m007. The label of this variable was changed once because there are two labels for these variables: 1) Is your father still alive? and 2) Is your biological father still alive? The answer categories were: yes = 1, no = 2, I don't know = 99 across all waves.\n\nThe variable with the same extension (last 3 letters/digits) **007** in the Personality survey (\"cp\") featured in 10 waves, from 2008 to 2018. It had the following names across those 10 waves: cp08a007, cp09b007, cp10c007, cp11d007, cp12e007, cp13f007, cp14g007, cp15h007, cp17i007, cp18j007. The label of this variable across waves was \"I receive far too many requests to participate in surveys\". Across all waves, there has been a change in labelling:  `1 totally disagree` = 1, `2` = 2, `3` = 3, `4` = 4, `5` = 5, `6` = 6, ` 7 totally agree` = 7 -- AND -- \n`1 totally disagree` = 1, `2` = 2, `3` = 3, `4` = 4, `5` = 5, `6` = 6, `7 totally agree` = 7. Note the extra space before the \" 7 totally agree\" in the first instance.\n",
    "supporting": [
      "2024-03-21-prefer-codebooks_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}